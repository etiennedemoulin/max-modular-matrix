{"version":3,"names":["LitElement","html","css","nothing","unsafeHTML","padLeft","value","size","str","length","SwAudit","styles","constructor","client","auditState","numClientsString","firstUpdated","getAuditState","onUpdate","updates","numClientsStrings","numClients","get","role","push","join","requestUpdate","render","avgLatency","avgLatencyString","toFixed","customElements","define"],"sources":["../../../src/clients/components/sw-audit.js"],"sourcesContent":["import { LitElement, html, css, nothing } from 'lit';\nimport { unsafeHTML } from 'lit/directives/unsafe-html.js';\n\nfunction padLeft(value, size) {\n  let str = value + ''; // cast to string\n\n  while (str.length <= size) {\n    str = `&nbsp;${str}`;\n  }\n\n  return str;\n}\n\n/**\n * component for the soundworks internal audit state\n */\nclass SwAudit extends LitElement {\n  static get styles() {\n    return css`\n      :host > div {\n        background-color: var(--sw-light-background-color);\n        height: 100%;\n        padding: 0 20px;\n      }\n    `;\n  }\n\n  constructor() {\n    super();\n\n    this.client = null;\n    this.auditState = null;\n    this.numClientsString = '';\n  }\n\n  async firstUpdated() {\n    this.auditState = await this.client.getAuditState();\n    this.auditState.onUpdate(updates => {\n      if ('numClients' in updates) {\n        const numClientsStrings = [];\n        const numClients = this.auditState.get('numClients');\n\n        for (let role in numClients) {\n          const str = `${role}: ${padLeft(numClients[role], 2)}`;\n          numClientsStrings.push(str);\n        }\n\n        this.numClientsString = numClientsStrings.join(' - ');\n      }\n\n      this.requestUpdate();\n    }, true);\n  }\n\n  render() {\n    if (this.auditState === null) {\n      return nothing;\n    }\n\n    const avgLatency = this.auditState.get('averageNetworkLatency');\n    const avgLatencyString = padLeft((avgLatency * 1e3).toFixed(2), 6);\n\n    return html`\n      <div>\n        ${unsafeHTML(this.numClientsString)} | avg latency: ${unsafeHTML(avgLatencyString)} ms\n      </div>\n    `;\n  }\n}\n\ncustomElements.define('sw-audit', SwAudit);\n"],"mappings":"AAAA,SAASA,UAAU,EAAEC,IAAI,EAAEC,GAAG,EAAEC,OAAO,QAAQ,KAAK;AACpD,SAASC,UAAU,QAAQ,+BAA+B;AAE1D,SAASC,OAAOA,CAACC,KAAK,EAAEC,IAAI,EAAE;EAC5B,IAAIC,GAAG,GAAGF,KAAK,GAAG,EAAE,CAAC,CAAC;;EAEtB,OAAOE,GAAG,CAACC,MAAM,IAAIF,IAAI,EAAE;IACzBC,GAAG,GAAI,SAAQA,GAAI,EAAC;EACtB;EAEA,OAAOA,GAAG;AACZ;;AAEA;AACA;AACA;AACA,MAAME,OAAO,SAASV,UAAU,CAAC;EAC/B,WAAWW,MAAMA,CAAA,EAAG;IAClB,OAAOT,GAAI;AACf;AACA;AACA;AACA;AACA;AACA,KAAK;EACH;EAEAU,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IAEP,IAAI,CAACC,MAAM,GAAG,IAAI;IAClB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtB,IAAI,CAACC,gBAAgB,GAAG,EAAE;EAC5B;EAEA,MAAMC,YAAYA,CAAA,EAAG;IACnB,IAAI,CAACF,UAAU,GAAG,MAAM,IAAI,CAACD,MAAM,CAACI,aAAa,CAAC,CAAC;IACnD,IAAI,CAACH,UAAU,CAACI,QAAQ,CAACC,OAAO,IAAI;MAClC,IAAI,YAAY,IAAIA,OAAO,EAAE;QAC3B,MAAMC,iBAAiB,GAAG,EAAE;QAC5B,MAAMC,UAAU,GAAG,IAAI,CAACP,UAAU,CAACQ,GAAG,CAAC,YAAY,CAAC;QAEpD,KAAK,IAAIC,IAAI,IAAIF,UAAU,EAAE;UAC3B,MAAMb,GAAG,GAAI,GAAEe,IAAK,KAAIlB,OAAO,CAACgB,UAAU,CAACE,IAAI,CAAC,EAAE,CAAC,CAAE,EAAC;UACtDH,iBAAiB,CAACI,IAAI,CAAChB,GAAG,CAAC;QAC7B;QAEA,IAAI,CAACO,gBAAgB,GAAGK,iBAAiB,CAACK,IAAI,CAAC,KAAK,CAAC;MACvD;MAEA,IAAI,CAACC,aAAa,CAAC,CAAC;IACtB,CAAC,EAAE,IAAI,CAAC;EACV;EAEAC,MAAMA,CAAA,EAAG;IACP,IAAI,IAAI,CAACb,UAAU,KAAK,IAAI,EAAE;MAC5B,OAAOX,OAAO;IAChB;IAEA,MAAMyB,UAAU,GAAG,IAAI,CAACd,UAAU,CAACQ,GAAG,CAAC,uBAAuB,CAAC;IAC/D,MAAMO,gBAAgB,GAAGxB,OAAO,CAAC,CAACuB,UAAU,GAAG,GAAG,EAAEE,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;IAElE,OAAO7B,IAAK;AAChB;AACA,UAAUG,UAAU,CAAC,IAAI,CAACW,gBAAgB,CAAE,mBAAkBX,UAAU,CAACyB,gBAAgB,CAAE;AAC3F;AACA,KAAK;EACH;AACF;AAEAE,cAAc,CAACC,MAAM,CAAC,UAAU,EAAEtB,OAAO,CAAC"}
